<html>
  <head>
    <title>Gradient-Composite Rendering</title>
    <script src="../nile.js"></script>
    <script src="../gezira.js"></script>
    <script src="shapes.js"></script>
    <script>

      function main() {
        var canvas = document.getElementsByTagName('canvas')[0];
        var cxt = canvas.getContext('2d');
        var star = shapes.star(canvas.width / 2, canvas.height / 2, 50, 100, 5);
        var background = new Image();
        background.src = 'sunset.jpg';
        cxt.drawImage(background, 0, 0);
        var image = cxt.getImageData(0, 0, canvas.width, canvas.height);
        with (gezira) {
          var r = RadialGradient(250, 250, 100);
          var c = GradientColorSpan(1, 0, 1, 0, -1, 0, -1, 1, 1);
          var s = CompositeSamplers(Gradient(r, GradientMirror, c),
                                    ReadImage(image),
                                    CompositeOver);
          nile.pipeline(DecomposeBezier,
                        Render(s, WriteImage(image)))(star.slice(0));
        }
        cxt.putImageData(image, 0, 0);
      };
    </script>
  </head>
  <body onload="main();">
    <canvas width=500 height=500></canvas>
  </body>
</html>
